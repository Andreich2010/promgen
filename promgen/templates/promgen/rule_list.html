{% extends "base.html" %}

{% block content %}

{% if service %}
<div class="page-header">
  <h1>Service: {{ service.name }}</h1>
</div>

<ol class="breadcrumb">
  <li><a href="{% url 'service-list' %}">Home</a></li>
  <li><a href="{% url 'service-detail' service.id %}">{{ service.name }}</a></li>
  <li class="active">List Rules</li>
</ol>
{% else %}
<div class="page-header">
  <h1>Rules</h1>
</div>

<ol class="breadcrumb">
  <li><a href="{% url 'service-list' %}">Home</a></li>
  <li class="active">List Rules</li>
</ol>
{% endif %}

<div class="panel panel-default">
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Name</th>
          <th>Clause</th>
          <th>Duration</th>
          <th>Labels</th>
          <th>Annotations</th>
          {% if service %}
          <th>&nbsp;</th>
          <th>&nbsp;</th>
          {% else %}
          <th>Service</th>
          {% endif %}
        </tr>
      </thead>
{% for rule in rule_list %}
      <tr>
        <td>{{ rule.name }}</td>
        <td>{{ rule.clause }}</td>
        <td>{{ rule.duration }}</td>
        <td>{{ rule.labels }}</td>
        <td>{{ rule.annotations }}</td>
        {% if service %}
        <td><a href="{% url 'rule-edit' rule.id %}" class="btn btn-primary">Edit</a></td>
        <td><form method="post" action="{% url 'rule-delete' rule.id %}" onsubmit="return confirm('Delete this rule?')" style="display: inline">
          {% csrf_token %}
          <button class="btn btn-danger">Delete</button>
        </form>
      </td>
        {% else %}
        <td><a href="{% url 'service-rules' rule.service.id %}">{{ rule.service }}</a></td>
        {% endif %}
      </tr>
{% endfor %}
    </table>

    {% if service %}
    <div class="panel-footer">
      <a href="{% url 'rule-new' service.id %}" class="btn btn-primary">
        Register new Rule</a>
    </div>
    {% endif %}

</div>

{% endblock %}
